<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Spells</title>
		<meta name="author" content="Cole">
		<meta name="keywords" content="dnd,5e,dungeons,dragons,magic,spells">
		<meta name="description" content="Spells">
		<script src="data/spells.js"></script>
		<script src="src/sort.js"></script>
		
		<script type="text/javascript">
			'use strict';
			
			function _element(id) {
				if ( id && Node.ELEMENT_NODE === id.nodeType ) return id;
				else if ( 'body' === id || 'head' === id ) return document[id];
				else return document.getElementById(id);
			}
			
			function _assignClass(element, c) {
				var result = 0;
				var action = ( arguments.length > 2 ) ? arguments[2] || 0 : 1
				
				if ( element.classList && 'function' === typeof element.classList.contains ) {
					if ( !(action > 0 || action < 0) ) {
						result = element.classList.toggle(c) ? 1 : -1
					} else if ( element.classList.contains(c) ) {
						result = !( action > 0 ) ? element.classList.remove(c) || -1 : 0
					} else {
						result = !( action < 0 ) ? element.classList.add(c) || 1 : 0
					}
				} else if ( element.className && 'function' === typeof element.className.search ) {
					var pattern = new RegExp('(^|\\s+)'+c+'(\\s+|$)');
					
					if ( element.className.search(pattern) < 0 ) {
						if ( !(action < 0) ) {
							element.className = element.className !== "" ? element.className + " " + c : c
							result = 1
						}
					} else {
						if ( !(action > 0) ) {
							element.className = element.className.replace(pattern, " ").trim()
							result = -1
						}
					}
				} else if ( !(action < 0) ) {
					element.className = c
					result = 1
				}
				
				return result;
			}
			
			function assignClassToElements(className, selector, ascend, rule) {
				var element, elements = document.querySelectorAll(selector)
				var value, climb, index = elements.length
				var count = index
				
				ascend = ascend || 0
				
				while ( index --> 0 ) {
					element = elements[index]
					value = rule(element)
					
					for ( climb = 0 ; climb < ascend ; ++climb ) {
						element = element.parentElement
					}
					
					if ( _assignClass(element, className, value) > 0 || value > 0 ) {
						count -= 1
					}
				}
				
				return count
			}
			
			function inflateParameters(result, string, leading, separator) {
				if ( string.charAt(0) === leading ) { string = string.slice(1) }
				
				var part, parts = string.split(separator)
				var object = result || {}
				var equals, value, key
				
				for ( part of parts ) {
					equals = part.indexOf('=')
					value = (equals < 0) ? true : decodeURIComponent(part.slice(equals + 1))
					key = (equals < 0) ? part : part.slice(0, equals)
					
					object[key] = value
				}
				
				return object
			}
			
			function selectorAssignChecked(selector, checked) {
				var selectorChecked = selector + ':checked'
				var selectorUnchecked = selector + ':not(:checked)'
				var element, elements, index
				
				if ( checked ) {
					checked = checked > 0
					elements = document.querySelectorAll(checked ? selectorUnchecked : selectorChecked)
				} else {
					var elementsChecked = document.querySelectorAll(selectorChecked)
					var elementsUnchecked = document.querySelectorAll(selectorUnchecked)
					
					checked = elementsUnchecked.length > elementsChecked.length
					elements = checked ? elementsUnchecked : elementsChecked
				}
				
				index = elements.length
				
				while ( index --> 0 ) {
					element = elements[index]
					
					if ( element.checked !== checked ) {
						element.checked = checked
						
						if ( typeof element.onchange === 'function' ) { element.onchange() }
					}
				}
			}
			
			function filterAssignToggleChecked(value) {
				selectorAssignChecked('table#primary-table tr:not(.filtered) > td.name > input.toggle', value)
			}
			
			function filterAssignChosenChecked(value) {
				selectorAssignChecked('table#primary-table tr:not(.filtered) > td.selected > input.selection', value)
			}
			
			function filterPrimaryByChosen() {
				var count = assignClassToElements('filtered', 'table#primary-table tr.primary > td.selected > input.selection', 2, function (e) { return e.checked ? -1 : 1 })
				
				filterApplied(count)
			}
			
			function filterPrimaryByToggle() {
				var count = assignClassToElements('filtered', 'table#primary-table tr.primary > td.name > input.toggle', 2, function (e) { return e.checked ? -1 : 1 })
				
				filterApplied(count)
			}
			
			function filterPrimaryByName(pattern) {
				var className = 'filtered'
				var selector = 'table#primary-table tr.primary > td.name'
				var count
				
				if ( !pattern ) {
					count = assignClassToElements(className, selector, 1, function (e) { return -1 })
					count = 0
				} else if ( pattern.search(/[[?*.|^${}\\]/) < 0 ) {
					pattern = pattern.toLowerCase()
					count = assignClassToElements(className, selector, 1, function (e) { return e.textContent.toLowerCase().indexOf(pattern) < 0 ? 1 : -1 })
				} else {
					try { pattern = new RegExp(pattern, 'ius') }
					catch (error) { return }
					
					count = assignClassToElements(className, selector, 1, function (e) { return e.textContent.search(pattern) < 0 ? 1 : -1 })
				}
				
				filterApplied(count)
				
				if ( count > 0 && count < 4 ) {
					filterAssignToggleChecked(1)
				}
			}
			
			function filterPrimaryByKeys(keys) {
				var form = _element('primary-form')
				var recognized = []
				var key
				
				for ( key of keys ) {
					if ( form['select_' + key] ) {
						form['select_' + key].checked = true
						recognized.push(key)
					}
				}
				
				console.log("filterPrimaryByKeys")
				console.log(keys)
				console.log(recognized)
				
				if ( recognized.length > 0 ) {
					filterPrimaryByChosen()
					
					if ( recognized.length < 20 ) {
						filterAssignToggleChecked(1)
					}
				}
			}
			
			function filterPrimaryBySearch(value) {
				if ( value === '#' ) {
					filterPrimaryByChosen()
				} else if ( value === '/' ) {
					filterPrimaryByToggle()
				} else {
					filterPrimaryByName(value)
				}
			}
			
			function filterApplied(count) {
				var element = _element('primary-filter-count')
				
				if ( element ) {
					element.textContent = count || ''
				}
				
				element = _element('select-all')
				
				handleSelect(false)
			}
			
			function handleHashChanged(event) {
				var hash = location.hash
				
				if ( hash && hash.length > 1 ) {
					var keys = hash.slice(1).split(",").map(function (s) { return s.trim() })
					
					filterPrimaryByKeys(keys)
					
					_element('primary-filter').value = '#'
				} else {
					filterPrimaryByName('')
				}
			}
			
			function handleSelect(key) {
				var share = _element('share-selection')
				var selector = 'table#primary-table tr:not(.filtered) > td.selected > input.selection'
				var elementsChecked = document.querySelectorAll(selector + ':checked')
				var elementsUnchecked = document.querySelectorAll(selector + ':not(:checked)')
				
				if ( share ) {
					var keys = Array.prototype.map.call(elementsChecked, function (e) { return e.id.slice(7) })
					var hash = keys.sort().join(",")
					
					share.href = "#" + hash
				}
				
				var all = _element('select-all')
				
				if ( all ) {
					all.indeterminate = elementsChecked.length > 0 && elementsUnchecked.length > 0
					all.checked = elementsChecked.length > elementsUnchecked.length
				}
			}
			
			function handleSearch(event) {
				var value = typeof event === 'string' ? event : event.target.value || ""
				
				filterPrimaryBySearch(value)
			}
			
			function handleSubmit(event) {
				var value = event.target.f.value
				
				filterPrimaryBySearch(value)
				
				event.preventDefault()
				
				return false
			}
			
			function stripDiacriticals(string) {
				if ( typeof string.normalize === 'function' ) {
					return string.normalize('NFD').replace(/[\u0300-\u036f]/g, "")
				} else {
					return string.replace('é', 'e')
				}
			}
			
			function referenceKey(name) {
				return stripDiacriticals(name.toLowerCase()).replace(/(['‘’()×.,:]+|[-+ \t]+|\ba\s|\bof\s|\bthe\s)/g, '')
			}
			
			function resolveReferences(text, object) {
				text = text.replace(/\{=([^{}]+)\}/g, function (match, list) {
					var part = list.split('/'), key = part[0], value = object[key]
					
					if ( value && part.length > 1 ) {
						switch ( part[1] ) {
						case 'l': value = value.toLocaleLowerCase(); break
						case 'u': value = value.toLocaleUpperCase(); break
						case 'a': value = "a"; break
						case 'at': value = "A"; break
						}
					}
					
					return "<span class='property " + key + "'>" + (value || '-') + "</span>"
				})
				
				text = text.replace(/\{@([^{} ]+)\s+([^{}]+)\}/g, function (match, type, list) {
					var part = list.split('|')
					
					switch ( type ) {
					case "h": return "<span class='entries hit italic'>Hit: " + list + "</span> "
					case "recharge": return "<span class='entries recharge'>" + list + "</span>"
					case "b": case "bold": return "<span class='entries bold'>" + list + "</span>"
					case "i": case "italic": return "<span class='entries italic'>" + list + "</span>"
					case "dice": case "damage": return "<span class='entries " + type + " italic' onclick='handleDice(event, \"" + part[0] + "\")'>" + (part[1] || part[0]) + "</span>"
					case "chance": return "<span class='entries " + type + "' onclick='handleChance(event, \"" + part[0] + "\")'>" + (part[1] || part[0] + " percent") + "</span>"
					case "link": return "<span class='entries " + type + " italic'>" + list + "</span>"
					case "hit": return (+list < 0 ? "" : "+") + list
					case "atk": return "<span class='entries attack italic'>" + list.replace(/./g, function (l) { return (["Ranged", "Melee", "Spell", "Weapon", "or"]["rmsw,".indexOf(l)] || l) + " " }) + " Attack:</span> "
					case "dc": return list
					case "item": return "<a class='entries item' href='items.html#" + referenceKey(part[0]) + "'>" + (part[2] || part[0]) + "</a>"
					case "spell": return "<a class='entries spell italic' href='spells.html#" + referenceKey(part[0]) + "'>" + (part[2] || part[0]) + "</a>"
					case "creature": return "<a class='entries creature' href='bestiary.html#" + referenceKey(part[0]) + "'>" + (part[2] || part[0]) + "</a>"
					case "condition": case "skill": case "sense": case "action": case "hazard": return "<span class='entries " + type + "'>" + part[0] + "</span>"
					case "filter": return (part.length > 2 && part[1] === 'spells') ? "<a class='entries spell italic' href='spells.html?" + part[2] + "'>" + part[0] + "</a>" : "<span class='entries italic " + type + "'>" + part[0] + "</span>"
					case "adventure": return "<span class='entries italic " + type + "'>" + part[0] + "</span>"
					case "table": return "<span class='entries italic " + type + "'>" + (part[2] || part[0]) + "</span>"
					case "book": return "<span class='entries italic " + type + "'>" + (part[3] || part[0]) + "</span>"
					default: return "<span class='entries italic " + type + "'>" + (part[2] || part[0]) + "</span>"
					}
				})
				
				text = text.replace(/\{@h\}/g, "<span class='entries hit italic'>Hit:</span> ")
				text = text.replace(/\{@recharge\}/g, "<span class='entries recharge'></span>")
				
				return text
			}
			
			function spellsReadyToDisplay(spells) {
				var result = []
				var keys = ['name', 'level', 'school', 'casting_time', 'range', 'components', 'material', 'duration', 'ritual', 'concentration', 'defense', 'attack', 'save', 'permanent', 'damage', 'damage_type', 'classes', 'desc', 'higher_level', 'book', 'page', 'circles', 'oaths', 'domains', 'patrons', 'archetype']
				var spell, value, styles, scalar, casting
				var s, key
				
				for ( s of spells ) {
					spell = 1 ? {} : {}
					styles = []
					
					spell['key'] = s.name.toLowerCase().replace(/[^a-z0-9]|.*['‘’]s /g, '')
					
					for ( key of keys ) {
						if ( s[key] !== undefined && s[key] !== false ) { spell[key] = s[key] }
					}
					
					value = spell['archetype']
					if ( value && value.length > 0 ) {
						value = value.concat(spell['classes'])
						value.sort()
						styles.push('archetype')
					} else {
						value = spell['classes']
					}
					spell['classnames'] = value.join(", ")
					spell['classstyles'] = value.map(function (c) { return c.replace(/[: ]+/g, '-') })
					
					styles.push('level-' + spell['level'])
					styles.push('book-' + spell['book'])
					styles.push('' + spell['school'].toLowerCase())
					styles.push.apply(styles, spell['classstyles'])
					styles.push(spell['higher_level'] ? 'has-higher-level' : 'not-higher-level')
					styles.push(spell['save'] ? 'has-save' : 'not-save')
					styles.push(spell['damage'] ? 'is-damage' : 'not-damage')
					styles.push(spell['attack'] ? 'is-attack' : 'not-attack')
					styles.push(spell['defense'] ? 'is-defense' : 'not-defense')
					styles.push(spell['permanent'] ? 'is-permanent' : 'not-permanent')
					styles.push(spell['ritual'] ? 'is-ritual' : 'not-ritual')
					styles.push(spell['concentration'] ? 'is-concentration' : 'not-concentration')
					
					value = spell['damage_type']
					if ( value && value != '*' ) { styles.push(value) }
					
					value = spell['casting_time'].toLowerCase()
					if ( value.indexOf('reaction') > 0 ) { casting = 1/32 }
					else if ( value.indexOf('bonus') > 0 ) { casting = 1/16 }
					else if ( value.indexOf('action') > 0 ) { casting = 1/8 }
					else if ( value.indexOf('minute') > 0 ) { casting = parseInt(value) || 1 }
					else if ( value.indexOf('hour') > 0 ) { casting = (parseInt(value) || 1) * 60 }
					else { casting = 0 }
					
					if ( casting < 1/16 ) { styles.push('reaction'); value = "Reaction" }
					else if ( casting < 1/8 ) { styles.push('bonusaction'); value = "Bonus" }
					else if ( casting < 1 ) { styles.push('action'); value = "Action" }
					else if ( casting < 60 ) { styles.push('cast-minutes'); value = casting + "m" }
					else { styles.push('cast-hours'); value = (casting / 60) + "h" }
					spell['castingkey'] = casting
					spell['casting'] = value
					
					scalar = 1
					value = spell['duration']
					if ( 'Up to ' === value.substring(0, 6) ) { value = value.substring(6); scalar = 15/16 }
					if ( value === 'Instantaneous' ) { value = 0 }
					else if ( value === 'Instantaneous/1 hour' ) { value = 61 }
					else if ( value === 'Until dispelled' ) { value = 2000000000 }
					else if ( value === 'Special' ) { value = 1000000000 }
					else if ( value.indexOf('round') > 0 ) { value = parseInt(value) * scalar / 10 }
					else if ( value.indexOf('minute') > 0 ) { value = parseInt(value) * scalar }
					else if ( value.indexOf('hour') > 0 ) { value = parseInt(value) * scalar * 60 }
					else if ( value.indexOf('day') > 0 ) { value = parseInt(value) * scalar * 1440 }
					else { value = 0 }
					spell['durationkey'] = value
					
					if ( value === 0 ) { styles.push('duration-instant') }
					else if ( value < 1 ) { styles.push('duration-rounds') }
					else if ( value < 60 ) { styles.push('duration-minutes') }
					else if ( value < 1440 ) { styles.push('duration-hours') }
					else { styles.push('duration-days') }
					
					value = spell['duration']
					value = value.replace('Up to ', '…')
					value = value.replace('Instantaneous/1 hour', 'Special')
					value = value.replace('Instantaneous', 'Instant')
					value = value.replace('Until dispelled', 'Dispel')
					spell['period'] = value
					
					value = spell['range']
					if ( value === 'Self' || value < 0 ) { value = 0 }
					else if ( value === 'Touch' || value === 0 ) { value = 1 }
					else if ( value === 'Sight' ) { value = 1000000000 }
					else if ( value === 'Unlimited' ) { value = 2000000000 }
					else if ( value.indexOf && value.indexOf('mile') > 0 ) { value = parseInt(value) * 5280 }
					spell['rangekey'] = value
					
					value = spell['higher_level']
					value = value ? value.replace("<p>", "<p class='higher-level'>") : ""
					spell['higher_level'] = value
					
					value = spell['save']
					spell['sv'] = value ? value.substring ? value.substring(0, 3) : "*" : ""
					
					spell['page'] = +spell.page || spell.page
					spell['styles'] = styles.join(" ")
					spell['ss'] = (spell['school'] === 'Illusion') ? 'Ill' : spell['school'].substring(0, 2)
					spell['vsm'] = spell['components'].join("")
					spell['namekey'] = spell.name.replace(/['‘’]/g, '')
					spell['title_ritual'] = spell.ritual ? ", Ritual " + Math.floor(spell.castingkey + 10) + " Minutes" : ""
					spell['title_concentration'] = spell.concentration ? "Concentration, " : ""
					spell['descriptionhtml'] = resolveReferences(s['desc'] || '', s)
					
					if ( spell['material'] === undefined ) { spell['material'] = '' }
					if ( spell['damage'] === undefined ) { spell['damage'] = '' }
					if ( spell['damage_type'] === undefined ) { spell['damage_type'] = '' }
					
					result.push(spell)
				}
				
				result.sort(function (a, b) { return (a.level - b.level) || a.name.localeCompare(b.name) })
				
				return result
			}
			
			function primaryTableContent() {
				var rowTemplate = "<tr id='item-{key}' class='primary spell {styles}'>" +
 					"<td class='selected spell-prepared'><input id='select-{key}' name='select_{key}' type='checkbox' class='selection' onchange='handleSelect(\"{key}\")' /> </td>" +
					"<td class='name spell-name' data-sort-key='{namekey}'>" +
						"<input id='toggle-{key}' name='toggle-{key}' type='checkbox' class='toggle' />" +
						"<label for='toggle-{key}' class='toggle spell-name'><a id='{key}' class='spell-name'>{name}</a></label>" +
						"<div class='toggled details'><div class='inner details'>" +
							"<p class='material'>{material}</p>" +
							"{descriptionhtml}{higher_level}" +
							"<p class='classnames'>{classnames}</p>" +
							"<p class='source page-{book}'><span class='page'>{page}</span></p>" +
						"</div></div>" +
					"</td>" +
					"<td class='spell-level numeric' data-sort-key='{level}' title='Level {level}'>{level}</td>" +
					"<td class='spell-school' data-sort-key='{ss}' title='{school}'>{ss}</td>" +
					"<td class='spell-casting' data-sort-key='{castingkey}' title='Casting Time {casting_time}{title_ritual}'>{casting}</td>" +
					"<td class='spell-range numeric' data-sort-key='{rangekey}' title='Range {range}'>{range}</td>" +
					"<td class='spell-components' data-sort-key='{vsm}' title='Components {vsm}'>{vsm}</td>" +
					"<td class='spell-duration' data-sort-key='{durationkey}' title='Duration {title_concentration}{duration}'>{period}</td>" +
					"<td class='spell-damage'>{damage}</td>" +
					//"<td class='spell-damage-type'>{damage_type}</td>" +
					//"<td class='spell-save'>{sv}</td>" +
				"</tr>"
				
				var header = "<tr id='header' class='primary spell header'>" +
 					"<th class='spell-prepared sortable' data-sort-invert> </th>" +
					"<th class='spell-name natural sortable' data-sort-format='locale'>Name</th>" +
					"<th class='spell-level numeric sortable sorted-ascending' data-sort-format='number'>Level</th>" +
					"<th class='spell-school natural sortable' data-sort-format='normal'>Sc</th>" +
					"<th class='spell-casting natural sortable' data-sort-format='number'>Time</th>" +
					"<th class='spell-range numeric sortable' data-sort-format='number'>Range</th>" +
					"<th class='spell-components natural sortable' data-sort-format='normal'>VSM</th>" +
					"<th class='spell-duration natural sortable' data-sort-format='number'>Duration</th>" +
					"<th class='spell-damage natural sortable' data-sort-format='natural'>Damage</th>" +
					//"<th class='spell-damage-type sortable' data-sort-format='natural'>Type</th>" +
					//"<th class='spell-save sortable' data-sort-format='natural'>Save</th>" +
				"</tr>"
				
				var list = spellsReadyToDisplay(spells)
				var pattern = /{([^ }]+)}/g
				var rows = list.map(function (item) { return rowTemplate.replace(pattern, function (match, key) { return item[key] }) })
				
				return header + rows.join("")
			}
			
			function populatePrimaryTable() {
				var table = _element('primary-table')
				var html = primaryTableContent()
				
				table.innerHTML = html
				tableSort(table)
			}
			
// 			function deflateParameters() {
// 				var separator = '.'
// 				var filters = []
// 				var form = _element('spells-form')
// 				
// 				var levels = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9].filter(v => _element('filter-level-' + v).checked)
// 				if ( levels.length > 0 && levels.length < 10 ) { filters.push('l=' + levels.join('')) }
// 				
// 				var crass = form.crass.value
// 				if ( crass && crass != 'any' ) { filters.push('c=' + crass) }
// 				
// 				var schools = ['a', 'c', 'd', 'e', 'v', 'i', 'n', 't'].filter(v => _element('filter-school-' + v).checked)
// 				if ( schools.length > 0 && schools.length < 8 ) { filters.push('s=' + schools.join('')) }
// 				
// 				var times = ['r', 'b', 'a', 'm', 'h'].filter(v => _element('filter-casting-' + v).checked)
// 				if ( times.length > 0 && times.length < 5 ) { filters.push('t=' + times.join('')) }
// 				
// 				var books = ['ph', 'xg', 'ee', 'sc', 'rt'].filter(v => _element('filter-book-' + v).checked)
// 				if ( books.length > 0 && books.length < 5 ) { filters.push('b=' + books.join('.')) }
// 				
// 				var and = ['ritual', 'concentration', 'defense', 'attack', 'save', 'damage', 'higher', 'permanent']
// 				var flags = and.map(v => form['filter-' + v].value).join('').replace(/-/g, '')
// 				if ( flags != '' ) { filters.push('a=' + flags) }
// 				
// 				var spells = form.everySpell.filter(key => form[key].checked).sort()
// 				if ( spells.length > 0 ) { filters.push('p=' + spells.join('.')) }
// 				
// 				return filters
// 			}
			
			function applyFilters(form, object) {
				var form = _element('primary-form')
				var key, value, values, v, V
				
				value = object['l'] || object['level'] || ''
				for ( v = 0 ; v < 10 ; ++v ) { _element('filter-level-' + v).checked = !(value && value.indexOf(v) < 0) }
				
				value = (object['c'] || object['class'] || 'any').toLowerCase()
				form['crass'].value = value
				
				value = (object['s'] || object['school'] || '').toLowerCase()
				values = ['a', 'c', 'd', 'e', 'v', 'i', 'n', 't']
				for ( v of values ) { _element('filter-school-' + v).checked = !(value && value.indexOf(v) < 0) }
				
				value = (object['t'] || object['time'] || '').toLowerCase()
				values = ['r', 'b', 'a', 'm', 'h']
				for ( v of values ) { _element('filter-casting-' + v).checked = !(value && value.indexOf(v) < 0) }
				
				value = (object['b'] || object['source'] || '').toLowerCase()
				values = ['ph', 'xg', 'ee', 'sc', 'rt']
				for ( v of values ) { _element('filter-book-' + v).checked = !(value.length > 0 && value.indexOf(v) < 0) }
				
				value = object['a'] || ''
				values = 0||{'r':'ritual', 'c':'concentration', 'f':'defense', 'a':'attack', 's':'save', 'd':'damage', 'h':'higher', 'p':'permanent'}
				for ( v in values ) { V = v.toUpperCase(); form['filter-' + values[v]].value = value.indexOf(v) < 0 ? value.indexOf(V) < 0 ? '-' : V : v }
			}
			
			function applyParameters() {
				var form = _element('primary-form')
				var object = inflateParameters(null, location.search, '?', '&')
				var key, value
				
				value = object['f']
				if ( value ) {
					form.f.value = value
					
					setTimeout(filterPrimaryByName, 0, value)
				}
				
				applyFilters(form, object)
			}
			
			function populatePage() {
				_element('primary-form').addEventListener('submit', handleSubmit)
				window.addEventListener('hashchange', handleHashChanged)
				
				populatePrimaryTable()
				applyParameters()
				handleHashChanged()
			}
		</script>
		
		<style>
			html {
				background: #EEE;
				overflow-y: scroll;
			}
			
			body {
				-webkit-font-smoothing: antialiased;
				-webkit-touch-callout: none;
				color: #555;
				background: #FFF;
				font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
				font-size: 14px;
				line-height: 1.75;
				padding: 2em;
				margin: 0 auto;
				max-width: 50em;
			}
			
			html { background-image: linear-gradient(270deg, rgb(230, 233, 233) 0%, rgb(216, 221, 221) 100%); }
			body { position:relative; box-shadow: 0 0 0.125em rgba(0, 0, 0, 0.06); }
			
			div#controls { position:absolute; right:2em; top:1.5em; }
			a#share-selection { font-size:150%; color:inherit; text-decoration:none; border-bottom:2px solid #999; }
			
			div#controls > button { border:solid #CCC 0.125em; border-radius:0.25em 0.25em; background:#EEE; min-width:4em; min-height:2em; }
			
			input#primary-filter { font-size:100%; max-width:98%; }
			span#primary-filter-count { opacity:0.5; font-size:60%; }
			
			input.toggle, input.filter { display:none; }
			input.toggle:not(:checked) ~ div.toggled { display:none; }
			input.toggle:not(:checked) + label + div.toggled { display:none; }
			
			div.details { position:relative; white-space:normal; width:0; }
			div.details > div.details.inner { position:relative; width:40em; max-width:70vw; padding:0 1em; margin:0.5em 0; background:#FAFAFA; border:1px solid #EEE; }
			div.details span.entries.indent + span.entries { margin-left:1em }
			
			table#primary-table label.toggle.close { display:none; }
			
			@media screen {
				table#primary-table label.toggle.close { display:inline-block; position:absolute; border-radius:50%; border:0.25em solid #EEE; bottom:0.375em; right:0.375em; }
				table#primary-table label.toggle.close { font-size:150%; text-align:center; line-height:1.125em; width:1.125em; height:1.125em; }
				table#primary-table input.toggle:checked + label.toggle > a:after { content:" ▲"; opacity:0.25; }
			}
			
			@media (max-width:600px) {
				body { padding:1em; font-size:80%; }
				div.details > div.details.inner { width:60vw; }
				th.spell-components, td.spell-components { display:none; }
				th.spell-damage, td.spell-damage { display:none; }
			}
			
			@media (max-width:420px) {
				body { font-size:2.8vmin; }
				th.spell-duration, td.spell-duration { display:none; }
				th.spell-range, td.spell-range { display:none; }
			}
			
			span.taper { display:inline-block; font-size:80%; }
			span.taper:first-letter { font-size:125%; }
			
			td.center, th.center { text-align:center; }
			td.natural, th.natural { text-align:left; }
			td.numeric, th.numeric { text-align:right; }
			
			table#primary-table { min-width:98%; padding:0; margin:1em 0 8em 0; border-spacing:0; border-collapse:collapse; }
			table#primary-table tr.primary { border-bottom:0.25px solid #DDD; }
			table#primary-table tr.primary > td, #primary-table tr.primary > th { vertical-align:baseline; padding:0.125em 1em 0.125em 0; }
			table#primary-table a.item-name { display:block; cursor:pointer; }
			
			table#primary-table { table-layout:fixed; width:100%; }
			table#primary-table tr.primary > th.spell-prepared { width:1.25em; }
			table#primary-table tr.primary > th.spell-level { width:2.5em; }
			table#primary-table tr.primary > th.spell-school { width:1.5em; }
			table#primary-table tr.primary > th.spell-casting { width:3.5em; }
			table#primary-table tr.primary > th.spell-range { width:4.5em; }
			table#primary-table tr.primary > th.spell-components { width:2em; }
			table#primary-table tr.primary > th.spell-duration { width:6em; }
			table#primary-table tr.primary > th.spell-damage { width:3em; }
			table#primary-table tr.primary > th.spell-source { width:3em; }
			
			p.higher-level:not(:empty):before { content:"At Higher Level. "; font-weight:bold; font-style:italic; }
			p.material:not(:empty):before { content:"Materials: "; font-weight:bold; }
			p.material:empty { display:none; }
			p.classnames:not(:empty):before { content:"Classes: "; font-weight:bold; }
			p.classnames:empty { display:none; }
			
			tr.is-ritual > td.casting:after { content:" ᴿ"; opacity:0.75; font-size:80%; }
			tr.is-concentration > td.duration { font-style:oblique; }
			tr.has-higher-level > td.level { font-style:oblique; }
			
			input.toggle, input.filter { display:none; }
			input.filter:not(:checked) + label { opacity:0.5; }
			input.toggle:not(:checked) ~ div.toggled { display:none; }
			input.toggle:not(:checked) + label + div.toggled { display:none; }
			
			td.item-type, td.item-source { font-size:80%; }
			div.details p:not(:first-of-type) { text-indent:1em; }
			div.details dl.entries > dt { font-weight:bold; }
			div.details .entries.italic { font-style:oblique; }
			div.details .entries.bold { font-weight:bold; }
			div.details span.prominent { font-weight:bold; }
			div.details span.prominent::after { content:"."; }
			div.details table.entries { border-spacing:0; border-collapse:collapse; }
			div.details table.entries td { vertical-align:top; }
			div.details table.entries td:not(:last-of-type) { padding-right:1em; }
			div.details table.entries td:first-child { min-width:4em; white-space:nowrap; }
			div.details table.entries tr:nth-child(even) { background:#FFF6F6; }
			div.details p.item-caption { font-style:oblique; }
			div.details a, div.details a:visited { text-decoration-color:#CCC; color:inherit; }
			p.source { font-style:oblique; color:#666; font-size:80%; }
			p.source > span.page:not(:empty)::before { content:" page "; }
			
			tr.filtered { display:none; }
			th.sortable.unsorted, th.sortable.sorted-descending { cursor:s-resize; }
			th.sortable.sorted-ascending { cursor:n-resize; }
			th.sortable.sorted-descending { text-decoration:overline; }
			th.sortable.sorted-ascending { text-decoration:underline; }
			
			input#filter-level-0:not(:checked) ~ table#primary-table tr.level-0 { display:none; }
			input#filter-level-1:not(:checked) ~ table#primary-table tr.level-1 { display:none; }
			input#filter-level-2:not(:checked) ~ table#primary-table tr.level-2 { display:none; }
			input#filter-level-3:not(:checked) ~ table#primary-table tr.level-3 { display:none; }
			input#filter-level-4:not(:checked) ~ table#primary-table tr.level-4 { display:none; }
			input#filter-level-5:not(:checked) ~ table#primary-table tr.level-5 { display:none; }
			input#filter-level-6:not(:checked) ~ table#primary-table tr.level-6 { display:none; }
			input#filter-level-7:not(:checked) ~ table#primary-table tr.level-7 { display:none; }
			input#filter-level-8:not(:checked) ~ table#primary-table tr.level-8 { display:none; }
			input#filter-level-9:not(:checked) ~ table#primary-table tr.level-9 { display:none; }
			
			input#filter-school-a:not(:checked) ~ table#primary-table tr.abjuration { display:none; }
			input#filter-school-c:not(:checked) ~ table#primary-table tr.conjuration { display:none; }
			input#filter-school-d:not(:checked) ~ table#primary-table tr.divination { display:none; }
			input#filter-school-e:not(:checked) ~ table#primary-table tr.enchantment { display:none; }
			input#filter-school-v:not(:checked) ~ table#primary-table tr.evocation { display:none; }
			input#filter-school-i:not(:checked) ~ table#primary-table tr.illusion { display:none; }
			input#filter-school-n:not(:checked) ~ table#primary-table tr.necromancy { display:none; }
			input#filter-school-t:not(:checked) ~ table#primary-table tr.transmutation { display:none; }
			
			input#filter-book-ph:not(:checked) ~ table#primary-table tr.book-phb { display:none; }
			input#filter-book-xg:not(:checked) ~ table#primary-table tr.book-xgte { display:none; }
			input#filter-book-ee:not(:checked) ~ table#primary-table tr.book-eepc { display:none; }
			input#filter-book-sc:not(:checked) ~ table#primary-table tr.book-scag { display:none; }
			input#filter-book-rt:not(:checked) ~ table#primary-table tr.book-trot { display:none; }
			
			input#filter-class-bard:checked ~ table#primary-table tr.spell:not(.Bard) { display:none; }
			input#filter-class-cleric:checked ~ table#primary-table tr.spell:not(.Cleric) { display:none; }
			input#filter-class-druid:checked ~ table#primary-table tr.spell:not(.Druid) { display:none; }
			input#filter-class-paladin:checked ~ table#primary-table tr.spell:not(.Paladin) { display:none; }
			input#filter-class-ranger:checked ~ table#primary-table tr.spell:not(.Ranger) { display:none; }
			input#filter-class-sorcerer:checked ~ table#primary-table tr.spell:not(.Sorcerer) { display:none; }
			input#filter-class-warlock:checked ~ table#primary-table tr.spell:not(.Warlock) { display:none; }
			input#filter-class-wizard:checked ~ table#primary-table tr.spell:not(.Wizard) { display:none; }
			
			input#filter-casting-r:not(:checked) ~ table#primary-table tr.reaction { display:none; }
			input#filter-casting-b:not(:checked) ~ table#primary-table tr.bonusaction { display:none; }
			input#filter-casting-a:not(:checked) ~ table#primary-table tr.action { display:none; }
			input#filter-casting-m:not(:checked) ~ table#primary-table tr.cast-minutes { display:none; }
			input#filter-casting-h:not(:checked) ~ table#primary-table tr.cast-hours { display:none; }
			input#filter-casting-o:not(:checked) ~ table#primary-table tr.cast-other { display:none; }
			
			label.trivia.disable > span { opacity:0.5; }
			label.trivia.exclude { position:relative; }
			label.trivia.exclude:after { content:""; position:absolute; left:-0.125em; right:-0.125em; bottom:30%; border-top:solid #C00 1.5px; }
			input.trivia { display:none; }
			input.trivia:not(:checked) + input.trivia + .trivia + label.trivia + label.trivia { display:none; }
			input.trivia:not(:checked) + label.trivia { display:none; }
			
			input#filter-ritual-require:checked ~ table#primary-table tr:not(.is-ritual):not(.header) { display:none; }
			input#filter-ritual-exclude:checked ~ table#primary-table tr.is-ritual { display:none; }
			input#filter-concentration-require:checked ~ table#primary-table tr:not(.is-concentration):not(.header) { display:none; }
			input#filter-concentration-exclude:checked ~ table#primary-table tr.is-concentration { display:none; }
			input#filter-attack-require:checked ~ table#primary-table tr:not(.is-attack):not(.header) { display:none; }
			input#filter-attack-exclude:checked ~ table#primary-table tr.is-attack { display:none; }
			input#filter-save-require:checked ~ table#primary-table tr:not(.has-save):not(.header) { display:none; }
			input#filter-save-exclude:checked ~ table#primary-table tr.has-save { display:none; }
			input#filter-higher-require:checked ~ table#primary-table tr:not(.has-higher-level):not(.header) { display:none; }
			input#filter-higher-exclude:checked ~ table#primary-table tr.has-higher-level { display:none; }
			input#filter-defense-require:checked ~ table#primary-table tr:not(.is-defense):not(.header) { display:none; }
			input#filter-defense-exclude:checked ~ table#primary-table tr.is-defense { display:none; }
			input#filter-damage-require:checked ~ table#primary-table tr:not(.is-damage):not(.header) { display:none; }
			input#filter-damage-exclude:checked ~ table#primary-table tr.is-damage { display:none; }
			input#filter-permanent-require:checked ~ table#primary-table tr:not(.is-permanent):not(.header) { display:none; }
			input#filter-permanent-exclude:checked ~ table#primary-table tr.is-permanent { display:none; }
			
			.action { cursor:pointer; }
			.filter, .trivia { cursor:pointer; -webkit-tap-highlight-color:transparent; }
			
			@media screen {
				tr.acid > td.spell-damage-type { color:#360; }
				tr.bludgeoning > td.spell-damage-type { color:#333; }
				tr.cold > td.spell-damage-type { color:#009; }
				tr.disease > td.spell-damage-type { }
				tr.fire > td.spell-damage-type { color:#900; }
				tr.force > td.spell-damage-type { color:#339; }
				tr.lightning > td.spell-damage-type { color:#983; }
				tr.necrotic > td.spell-damage-type { color:#306; }
				tr.piercing > td.spell-damage-type { color:#333; }
				tr.poison > td.spell-damage-type { color:#060; }
				tr.psychic > td.spell-damage-type { color:#069; }
				tr.radiant > td.spell-damage-type { color:#960; }
				tr.slashing > td.spell-damage-type { color:#333; }
				tr.thunder > td.spell-damage-type { }
			}
			
			@media print {
				th.item-selected, td.item-selected { display:none; }
				div.filtering, div.controls { display:none; }
				p.source { page-break-after:always; }
			}
			
			.nose, .reroll, .action {
				-webkit-touch-callout:none;
				-webkit-user-select:none;
				-moz-user-select:none;
				-ms-user-select:none;
				-o-user-select:none;
				user-select:none;
			}
		</style>
	</head>
	<body onload='populatePage()'>
		<h4>Spells</h4>
		
		<div id='primary-content-list'>
			<form id='primary-form'>
				<div id='controls'>
					<button type='reset' title='Show all spells'>↻</button>
					<a id='share-selection' href='' title='Share selection'>⇧</a>
				</div>
				
				<div class='filtering'>
					<input type='checkbox' id='select-all' name='a' onclick='filterAssignChosenChecked(checked ? 1 : -1)' title='Tap to select matches.' />
					<label for='select-all'>&nbsp;</label>
					<input type='search' id='primary-filter' name='f' size='36' placeholder='Filter' oninput='handleSearch(event)'>
					<span id='primary-filter-count' class='action' onclick='filterAssignToggleChecked()' title='Number of matches.  Tap to expand.'></span>
				</div>
				
				<br /><span class='caption taper'>Level:</span>
				<input id='filter-level-0' type='checkbox' checked class='filter' /><label for='filter-level-0' class='filter'>0</label>
				<span>&bull;</span> <input id='filter-level-1' type='checkbox' checked class='filter' /><label for='filter-level-1' class='filter'>1</label>
				<span>&bull;</span> <input id='filter-level-2' type='checkbox' checked class='filter' /><label for='filter-level-2' class='filter'>2</label>
				<span>&bull;</span> <input id='filter-level-3' type='checkbox' checked class='filter' /><label for='filter-level-3' class='filter'>3</label>
				<span>&bull;</span> <input id='filter-level-4' type='checkbox' checked class='filter' /><label for='filter-level-4' class='filter'>4</label>
				<span>&bull;</span> <input id='filter-level-5' type='checkbox' checked class='filter' /><label for='filter-level-5' class='filter'>5</label>
				<span>&bull;</span> <input id='filter-level-6' type='checkbox' checked class='filter' /><label for='filter-level-6' class='filter'>6</label>
				<span>&bull;</span> <input id='filter-level-7' type='checkbox' checked class='filter' /><label for='filter-level-7' class='filter'>7</label>
				<span>&bull;</span> <input id='filter-level-8' type='checkbox' checked class='filter' /><label for='filter-level-8' class='filter'>8</label>
				<span>&bull;</span> <input id='filter-level-9' type='checkbox' checked class='filter' /><label for='filter-level-9' class='filter'>9</label>
				
				<br /><span class='caption taper'>Class:</span>
				<input id='filter-class-any' name='crass' value='any' type='radio' checked class='filter' /><label for='filter-class-any' class='filter' title='Any'><span class='taper'>Any</span></label>
				<span>&bull;</span> <input id='filter-class-bard' name='crass' value='bard' type='radio' class='filter' /><label for='filter-class-bard' class='filter' title='Bard'><span class='taper'>Bard</span></label>
				<span>&bull;</span> <input id='filter-class-cleric' name='crass' value='cleric' type='radio' class='filter' /><label for='filter-class-cleric' class='filter' title='Cleric'><span class='taper'>Cleric</span></label>
				<span>&bull;</span> <input id='filter-class-druid' name='crass' value='druid' type='radio' class='filter' /><label for='filter-class-druid' class='filter' title='Druid'><span class='taper'>Druid</span></label>
				<span>&bull;</span> <input id='filter-class-paladin' name='crass' value='paladin' type='radio' class='filter' /><label for='filter-class-paladin' class='filter' title='Paladin'><span class='taper'>Paladin</span></label>
				<span>&bull;</span> <input id='filter-class-ranger' name='crass' value='ranger' type='radio' class='filter' /><label for='filter-class-ranger' class='filter' title='Ranger'><span class='taper'>Ranger</span></label>
				<span>&bull;</span> <input id='filter-class-sorcerer' name='crass' value='sorcerer' type='radio' class='filter' /><label for='filter-class-sorcerer' class='filter' title='Sorcerer'><span class='taper'>Sorcerer</span></label>
				<span>&bull;</span> <input id='filter-class-warlock' name='crass' value='warlock' type='radio' class='filter' /><label for='filter-class-warlock' class='filter' title='Warlock'><span class='taper'>Warlock</span></label>
				<span>&bull;</span> <input id='filter-class-wizard' name='crass' value='wizard' type='radio' class='filter' /><label for='filter-class-wizard' class='filter' title='Wizard'><span class='taper'>Wizard</span></label>
				
				<br /><span class='caption taper'>School:</span>
				<input id='filter-school-a' type='checkbox' checked class='filter' /><label for='filter-school-a' class='filter' title='Abjuration'><span class='taper'>Abjuration</span></label>
				<span>&bull;</span> <input id='filter-school-c' type='checkbox' checked class='filter' /><label for='filter-school-c' class='filter' title='Conjuration'><span class='taper'>Conjuration</span></label>
				<span>&bull;</span> <input id='filter-school-d' type='checkbox' checked class='filter' /><label for='filter-school-d' class='filter' title='Divination'><span class='taper'>Divination</span></label>
				<span>&bull;</span> <input id='filter-school-e' type='checkbox' checked class='filter' /><label for='filter-school-e' class='filter' title='Enchantment'><span class='taper'>Enchantment</span></label>
				<span>&bull;</span> <input id='filter-school-v' type='checkbox' checked class='filter' /><label for='filter-school-v' class='filter' title='Evocation'><span class='taper'>Evocation</span></label>
				<span>&bull;</span> <input id='filter-school-i' type='checkbox' checked class='filter' /><label for='filter-school-i' class='filter' title='Illusion'><span class='taper'>Illusion</span></label>
				<span>&bull;</span> <input id='filter-school-n' type='checkbox' checked class='filter' /><label for='filter-school-n' class='filter' title='Necromancy'><span class='taper'>Necromancy</span></label>
				<span>&bull;</span> <input id='filter-school-t' type='checkbox' checked class='filter' /><label for='filter-school-t' class='filter' title='Transmutation'><span class='taper'>Transmutation</span></label>
				
				<br /><span class='caption taper'>Casting Time:</span>
				<input id='filter-casting-r' type='checkbox' checked class='filter' /><label for='filter-casting-r' class='filter' title='Reaction'><span class='taper'>Reaction</span></label>
				<span>&bull;</span> <input id='filter-casting-b' type='checkbox' checked class='filter' /><label for='filter-casting-b' class='filter' title='Bonus Action'><span class='taper'>Bonus Action</span></label>
				<span>&bull;</span> <input id='filter-casting-a' type='checkbox' checked class='filter' /><label for='filter-casting-a' class='filter' title='Action'><span class='taper'>Action</span></label>
				<span>&bull;</span> <input id='filter-casting-m' type='checkbox' checked class='filter' /><label for='filter-casting-m' class='filter' title='Minutes'><span class='taper'>Minutes</span></label>
				<span>&bull;</span> <input id='filter-casting-h' type='checkbox' checked class='filter' /><label for='filter-casting-h' class='filter' title='Hours'><span class='taper'>Hours</span></label>
				
				<br /><span class='caption taper'>Source:</span>
				<input id='filter-book-ph' type='checkbox' checked class='filter' /><label for='filter-book-ph' class='filter' title='Players Handbook'><span class='taper'>Players Handbook</span></label>
				<span>&bull;</span> <input id='filter-book-xg' type='checkbox' checked class='filter' /><label for='filter-book-xg' class='filter' title='Xanathar’s Guide To Everything'><span class='taper'>Xanathars</span></label>
				<span>&bull;</span> <input id='filter-book-ee' type='checkbox' checked class='filter' /><label for='filter-book-ee' class='filter' title='Elemental Evil Player’s Companion'><span class='taper'>Elemental Evil</span></label>
				<span>&bull;</span> <input id='filter-book-sc' type='checkbox' checked class='filter' /><label for='filter-book-sc' class='filter' title='Sword Coast Adventure Guide'><span class='taper'>Sword Coast</span></label>
				<span>&bull;</span> <input id='filter-book-rt' type='checkbox' checked class='filter' /><label for='filter-book-rt' class='filter' title='The Rise of Tiamat'><span class='taper'>Tiamat</span></label>
				
				<br /><span class='caption taper'>And:</span>
				<input id='filter-ritual-disable' name='filter-ritual' value='-' type='radio' checked class='trivia' />
				<input id='filter-ritual-require' name='filter-ritual' value='R' type='radio' class='trivia' />
				<input id='filter-ritual-exclude' name='filter-ritual' value='r' type='radio' class='trivia' />
				<label for='filter-ritual-disable' class='trivia exclude'><span class='taper'>Ritual</span></label>
				<label for='filter-ritual-require' class='trivia disable'><span class='taper'>Ritual</span></label>
				<label for='filter-ritual-exclude' class='trivia require'><span class='taper'>Ritual</span></label>
				
				<span>&bull;</span>
				<input id='filter-concentration-disable' name='filter-concentration' value='-' type='radio' checked class='trivia' />
				<input id='filter-concentration-require' name='filter-concentration' value='C' type='radio' class='trivia' />
				<input id='filter-concentration-exclude' name='filter-concentration' value='c' type='radio' class='trivia' />
				<label for='filter-concentration-disable' class='trivia exclude'><span class='taper'>Concentration</span></label>
				<label for='filter-concentration-require' class='trivia disable'><span class='taper'>Concentration</span></label>
				<label for='filter-concentration-exclude' class='trivia require'><span class='taper'>Concentration</span></label>
				
				<span>&bull;</span>
				<input id='filter-defense-disable' name='filter-defense' value='-' type='radio' checked class='trivia' />
				<input id='filter-defense-require' name='filter-defense' value='F' type='radio' class='trivia' />
				<input id='filter-defense-exclude' name='filter-defense' value='f' type='radio' class='trivia' />
				<label for='filter-defense-disable' class='trivia exclude'><span class='taper'>Defense</span></label>
				<label for='filter-defense-require' class='trivia disable'><span class='taper'>Defense</span></label>
				<label for='filter-defense-exclude' class='trivia require'><span class='taper'>Defense</span></label>
				
				<span>&bull;</span>
				<input id='filter-attack-disable' name='filter-attack' value='-' type='radio' checked class='trivia' />
				<input id='filter-attack-require' name='filter-attack' value='A' type='radio' class='trivia' />
				<input id='filter-attack-exclude' name='filter-attack' value='a' type='radio' class='trivia' />
				<label for='filter-attack-disable' class='trivia exclude'><span class='taper'>Attack</span></label>
				<label for='filter-attack-require' class='trivia disable'><span class='taper'>Attack</span></label>
				<label for='filter-attack-exclude' class='trivia require'><span class='taper'>Attack</span></label>
				
				<span>&bull;</span>
				<input id='filter-save-disable' name='filter-save' value='-' type='radio' checked class='trivia' />
				<input id='filter-save-require' name='filter-save' value='S' type='radio' class='trivia' />
				<input id='filter-save-exclude' name='filter-save' value='s' type='radio' class='trivia' />
				<label for='filter-save-disable' class='trivia exclude'><span class='taper'>Save</span></label>
				<label for='filter-save-require' class='trivia disable'><span class='taper'>Save</span></label>
				<label for='filter-save-exclude' class='trivia require'><span class='taper'>Save</span></label>
				
				<span>&bull;</span>
				<input id='filter-damage-disable' name='filter-damage' value='-' type='radio' checked class='trivia' />
				<input id='filter-damage-require' name='filter-damage' value='D' type='radio' class='trivia' />
				<input id='filter-damage-exclude' name='filter-damage' value='d' type='radio' class='trivia' />
				<label for='filter-damage-disable' class='trivia exclude'><span class='taper'>Damage</span></label>
				<label for='filter-damage-require' class='trivia disable'><span class='taper'>Damage</span></label>
				<label for='filter-damage-exclude' class='trivia require'><span class='taper'>Damage</span></label>
				
				<span>&bull;</span>
				<input id='filter-higher-disable' name='filter-higher' value='-' type='radio' checked class='trivia' />
				<input id='filter-higher-require' name='filter-higher' value='H' type='radio' class='trivia' />
				<input id='filter-higher-exclude' name='filter-higher' value='h' type='radio' class='trivia' />
				<label for='filter-higher-disable' class='trivia exclude'><span class='taper'>Higher</span></label>
				<label for='filter-higher-require' class='trivia disable'><span class='taper'>Higher</span></label>
				<label for='filter-higher-exclude' class='trivia require'><span class='taper'>Higher</span></label>
				
				<span>&bull;</span>
				<input id='filter-permanent-disable' name='filter-permanent' value='-' type='radio' checked class='trivia' />
				<input id='filter-permanent-require' name='filter-permanent' value='P' type='radio' class='trivia' />
				<input id='filter-permanent-exclude' name='filter-permanent' value='p' type='radio' class='trivia' />
				<label for='filter-permanent-disable' class='trivia exclude'><span class='taper'>Permanent</span></label>
				<label for='filter-permanent-require' class='trivia disable'><span class='taper'>Permanent</span></label>
				<label for='filter-permanent-exclude' class='trivia require'><span class='taper'>Permanent</span></label>
				
				<table id='primary-table'><tr><td>Loading...</td></tr></table>
			</form>
		</div>
	</body>
</html>
